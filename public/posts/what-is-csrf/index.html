<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="In this article we explore the technical and business impacts 
that CSRF could have on your organisation."><title>What is Cross Site Request Forgery (CSRF)?</title><link rel=canonical href=/posts/what-is-csrf/><link rel=stylesheet href=/scss/style.min.css><meta property="og:title" content="What is Cross Site Request Forgery (CSRF)?"><meta property="og:description" content="In this article we explore the technical and business impacts 
that CSRF could have on your organisation."><meta property="og:url" content="/posts/what-is-csrf/"><meta property="og:site_name" content="Planet Lodder"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:tag" content="security"><meta property="article:published_time" content="2023-11-06T00:00:00+00:00"><meta property="article:modified_time" content="2023-11-06T00:00:00+00:00"><meta name=twitter:title content="What is Cross Site Request Forgery (CSRF)?"><meta name=twitter:description content="In this article we explore the technical and business impacts 
that CSRF could have on your organisation."></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex
on-phone--column compact"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header class=site-info><h1 class=site-name><a href>Planet Lodder</a></h1><h2 class=site-description></h2></header><ol class=menu id=main-menu><li><a href=/about/><span>About</span></a></li><li><a href=/posts/><span>Blog Posts</span></a></li></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><h2 class=article-title><a href=/posts/what-is-csrf/>What is Cross Site Request Forgery (CSRF)?</a></h2><h3 class=article-subtitle>In this article we explore the technical and business impacts
that CSRF could have on your organisation.</h3><footer class=article-time><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--published>Nov 06, 2023</time></footer></div></header><section class=article-content><blockquote><h3 id=intended-audience>Intended audience</h3><p>If you want to understand what CSRF is, and the impact it could have on your organisation, continue reading this article. This article was written for both <strong>business stakeholders</strong> and <strong>technical professionals</strong>.</p><p>We assume that you have at least a basic understanding of how websites work, more specifically, the <a class=link href=https://medium.com/@algorithmsunlocks/a-brief-explanation-of-the-request-response-model-in-web-development-b0081165cd67 target=_blank rel=noopener>request-response model</a>.</p></blockquote><p>There are 4 dedicated sections, depending on your interest and skill level:</p><ul><li><a class=link href=#example-of-a-typical-csrf-attack>Basic example of CSRF</a></li><li><a class=link href=#business-impacts-of-csrf>Business impact of CSRF</a></li><li><a class=link href=#technical-impacts-of-csrf>Technical impact of CSRF</a></li><li><a class=link href=#preventing-csrf-attacks>Preventing CSRF attacks</a></li></ul><h1 id=example-of-a-typical-csrf-attack>Example of a typical CSRF attack</h1><p>Lets start with a very basic example of what a typical CSRF attack looks like. From <a class=link href=https://owasp.org/www-community/attacks/csrf target=_blank rel=noopener>OWASP</a>, we have the following definition:</p><blockquote><p>Cross-Site Request Forgery (CSRF) is an attack that forces an end user to execute unwanted actions on a web application in which theyâ€™re currently authenticated.</p></blockquote><p>In the example below, we have a malicious user, that tricks a legitimate user, into clicking a link. This link will send a request (from the victim&rsquo;s machine), to a website that they are currently logged into.</p><p><img src=/images/CSRF_basics.png alt="Basic example of a CSRF attack"></p><p>Seeing that the request originates from the victim&rsquo;s computer, it looks like a legitimate request from the user to the web server, and this server will happily try and process the request on behalf of the user.</p><p>In the example above, the attacker uses a <a class=link href=https://en.wikipedia.org/wiki/Hyperlink target=_blank rel=noopener><em>hyperlink</em></a> and is attempting to transfer money from a victim&rsquo;s account using <a class=link href=https://www.enisa.europa.eu/topics/incident-response/glossary/what-is-social-engineering target=_blank rel=noopener><em>social engineering</em></a> techniques. This is <em>just one of many ways</em> the CSRF vulnerability can be exploited, but the basic idea stays the same: <em>trick a user into doing something unintentional</em>, that benefits the attacker.</p><p>We will cover more advanced techniques & attack vectors <a class=link href=#tactics-techniques-and-procedures-ttp>in an upcoming section</a>, but first, let&rsquo;s zoom out bit and take a look at the business implications CSRF can have on an organisation.</p><h1 id=business-impacts-of-csrf>Business Impacts of CSRF</h1><p>The successful exploitation of a CSRF attack could have far-reaching implications for any organisation. Some of the most common business risks include:</p><ul><li><a class=link href=#financial-loss--reputational-damage>Financial loss / Reputational damage</a></li><li><a class=link href=#unauthorised-data-access--fraudulent-modifications>Unauthorised data access / Fraudulent modifications</a></li><li><a class=link href=#employee-impersonation--communication-breaches>Employee impersonation / Communication breaches</a></li><li><a class=link href=#data-loss--operational-downtime>Data Loss / Operational Downtime</a></li><li><a class=link href=#compliance-governance-and-regulations>Compliance, governance and regulations</a></li></ul><p>Lets explore each one of these business risks in more detail, and see how they have an impact on business value.</p><h2 id=financial-loss--reputational-damage>Financial loss / Reputational damage</h2><p>One of the most important business implications, is the <em>financial impact</em> that a cyber attack can have on an organisation. Things that can negatively impact business profits include, for example:</p><ul><li>Physical assets (servers) that needs to be replaced</li><li>Operational downtime, meaning missed revenue</li><li>Loss of customers, due to reputational damage</li><li>Fines and legal implications for non-compliance</li></ul><p>Business value comes in many forms, not just financial. For example, reputational damage could lead to <em>a loss of customers confidence</em>, and cause business churn or lower sales revenue.</p><h2 id=unauthorised-data-access--fraudulent-modifications>Unauthorised data access / Fraudulent modifications</h2><p>Seeing that this technique leverages ways to trick the user into doing something they did not intend to do, there is a real threat of a malicious threat actor getting access to sensitive data, or even worse, fraudulently modifying that data.</p><p>As illustrated in the <a class=link href=#example-of-a-typical-csrf-attack>example above</a>, this could be in the form of a fraudulent money transfer, but could also be more subtle. For example, changing the user&rsquo;s banking details, email address, or other means of extracting value from a user.</p><p>Auditing and tracking these fraudulent transactions could also be difficult, seeing that the victim user&rsquo;s fingerprints are on the transaction, not the malicious user&rsquo;s.</p><p>There is also a real risk of data exfiltration, meaning sensitive data is stolen and copied outside of the organisation&rsquo;s control.</p><h2 id=employee-impersonation--communication-breaches>Employee impersonation / Communication breaches</h2><p>If the target victim is an employee of the company, unauthorized data access and modification can become an even a bigger risk.</p><p>For example, if an attacker can successfully change a user&rsquo;s login details, or email address, to something the attacker controls, they can essentially take over that user&rsquo;s account.</p><p>A more subtle risk would be if the malicious user can intercept confidential communications. This could allow the attacker access to sensitive (internal) communications. They could use this to their benefit (eg: insider trading, leaking or selling IP).</p><p>If the user (victim) is authorized to make statements on behalf of the company, this could also be used to communicate wrong or misleading information to your customers and investors, once again contributing to reputational damage.</p><h2 id=data-loss--operational-downtime>Data Loss / Operational Downtime</h2><p>In some use cases, CSRF vulnerabilities could also lead to <em>data loss</em> or <em>data corruption</em>.</p><p>From a business perspective, this is important, as it could lead to operational downtime, or even worse, missing transactional records needed for accounting purposes.</p><p>A good disaster recovery plan can help mitigate this risk, but even with a fully up-to-date and backed up database, there is still the risk that the CSRF vulnerability is present in your backup.</p><p>The implication being, even on a freshly installed new system, the vulnerability could still potentially be hiding in your data. This could give the attacker the ability to re-gain access and control.</p><h2 id=compliance-governance-and-regulations>Compliance, governance and regulations</h2><p>This point is often overlooked, but companies and organisations have to comply with certain rules and regulations. This varies from industry to industry, and country to country.</p><p>As an example, if you process credit card transactions, then <a class=link href=https://listings.pcisecuritystandards.org/documents/PCI_DSS-QRG-v3_2_1.pdf target=_blank rel=noopener>PCI DSS</a> (Payment Card Industry Data Security Standard) comes into play. Unauthorised access to a customer&rsquo;s credit card details, is punishable with a fine or even a class action lawsuit.</p><p>In Europe, another common one would be <a class=link href=https://eur-lex.europa.eu/EN/legal-content/summary/general-data-protection-regulation-gdpr.html target=_blank rel=noopener>GDPR</a> compliance, where organisations are responsible for safeguarding personal information about EU citizens, punishable with a fine.</p><p>For the health industry (especially in the US), there is also <a class=link href="https://www.cdc.gov/phlp/publications/topic/hipaa.html#:~:text=The%20Health%20Insurance%20Portability%20and,the%20patient%27s%20consent%20or%20knowledge." target=_blank rel=noopener>HIPPA</a> (Health Insurance Portability and Accountability Act). Failure to comply can lead to huge fines.</p><p>Typically, fines are set as a percentage of total yearly revenue, meaning it could have a huge impact on your companies profit margins.</p><h1 id=technical-impacts-of-csrf>Technical Impacts of CSRF</h1><p>We already covered the business risks associated with CSRF&rsquo;s, but lets now go a bit deeper. Let&rsquo;s see the technical impacts such an vulnerability can have on your IT system.</p><ul><li><a class=link href=#technical-risks-associated-with-csrf><strong>Risks</strong></a> - We will first look at the most common risks to IT systems and infrastructure</li><li><a class=link href=#common-attack-vectors><strong>Attack Vectors</strong></a> - Then cover some common methods that are used in the wild for exploitation</li><li><a class=link href=#tactics-techniques-and-procedures-ttp><strong>Indicators of Compromise</strong></a> - Then look at common tactics, techniques and procedures (TTP&rsquo;s)</li></ul><h2 id=technical-risks-associated-with-csrf>Technical risks associated with CSRF</h2><p>We have two perspectives to consider:</p><ul><li><p>From an IT systems perspective a successful CSRF attack is essentially hijacking a valid (and authenticated) victim&rsquo;s user account, to do something <em>bad</em>.</p></li><li><p>From a threat actors point of view, changing user data or state would be low hanging fruit, if unprotected. For example, changing user profile & billing options (eg: email address, password, banking details).</p></li></ul><p>This could also be used to force user purchases or other transactions without the users consent. For example, subscribing to a service that the attacker benefits from in some way.</p><p>If the user is an administrator, then the risk increases significantly, as the admin user typically has elevated privileges. Imagine for example, maliciously inviting or promoting other collaborators / users with admin privileges (without the administrators consent).</p><p>Two factor and MFA already goes a long way to mitigate these risks, but users are often reluctant and not willing to go through the extra steps. Good MFA policies should be in place and enforced in your IT systems, especially for administrative accounts.</p><h2 id=common-attack-vectors>Common Attack Vectors</h2><p>There are well know attack vectors used for successful CSRF exploitation, the common ones being:</p><ul><li><a class=link href=https://crashtest-security.com/csrf-login-attack/ target=_blank rel=noopener><strong>Login CSRF</strong></a> - <em>Force (authenticated) user to execute request to website</em></li><li><a class=link href=https://crashtest-security.com/stored-csrf-attack/ target=_blank rel=noopener><strong>Stored CSRF</strong></a> - <em>Chained with XSS, spreads to other users (<strong>amplifies severity</strong>)</em></li></ul><p>Often times, vulnerabilities get <em>chained together</em> (like in the case of stored CSRF), increasing their reach and severity significantly.</p><p>In the next section we will look into how these attack vectors can be chained together, and describe the tactics, techniques and procedures in more detail.</p><h2 id=tactics-techniques-and-procedures-ttp>Tactics, Techniques and Procedures (TTP)</h2><p>Generally speaking, this refers to the behavior of a malicious actor.</p><ul><li><strong>Tactics</strong> refer to the high-level overview of the behavior.</li><li><strong>Techniques</strong> provide detailed descriptions of the behavior, relating to the tactic.</li><li><strong>Procedures</strong> are highly detailed descriptions of the technique.</li></ul><p>This forms part of what is called <a class=link href=https://en.wikipedia.org/wiki/Indicator_of_compromise target=_blank rel=noopener><em>Indicators of Compromise</em> (IOC)</a>. They are used to do advanced threat detection. One good example of a framework that uses these IOC&rsquo;s, is the <a class=link href=https://attack.mitre.org/ target=_blank rel=noopener>Mitre ATT&amp;CK</a> framework.</p><p>Lets consider 3 use cases, where the first one is a pure CSRF exploit, then some examples that uses chained exploits to create an even more devastating attack vector.</p><blockquote><p><strong>Tactic:</strong> Social Engineering + URL hijacking</p><p><strong>Technique:</strong></p><ul><li>Building an exploit URL or script that has a CSRF vulnerability</li><li>Trick users into clicking the URL using Social Engineering (eg: post on Social Media)</li><li>URL opens in the browser of the target victim, sends request (validated as target user)</li><li>(Optionally) Force user to log onto credential stealing clone of the original website</li></ul><p><strong>Procedure:</strong> <a class=link href=https://attack.mitre.org/techniques/T1566/#examples target=_blank rel=noopener>T1566</a> <em>(MITRE Attack Framework)</em> - <em>Phishing</em></p></blockquote><blockquote><p><strong>Tactic:</strong> Using code injection <em>(eg, chained with XSS)</em></p><p><strong>Technique:</strong></p><ul><li>Find way to inject unsanitized (HTML) input into a vulnerable website</li><li>Build a malicious HTML tag, (eg: IMG that triggers code)</li><li>Submit malicious input to the server, stored and rendered on subsequent page loads</li><li>Wait for authenticated users to login, and trigger the malicious code</li><li>Malicious requests submitted to the server (forged, from the victim user&rsquo;s machine)</li><li>(Optionally) Attempt account takeover by changing user&rsquo;s email address / other details</li></ul><p><strong>Procedure:</strong> <a class=link href=https://attack.mitre.org/techniques/T1608/004/#examples target=_blank rel=noopener>T1608</a> <em>(MITRE Attack Framework)</em> - <em>Drive-by Target</em></p></blockquote><blockquote><p><strong>Tactic:</strong> Watering hole attacks <em>(eg, chained with XSS + CORS)</em></p><p><strong>Technique:</strong></p><ul><li>Goal is to expose/identify users of a targeted website (eg: track user activity)</li><li>Same as the previous one (chained with XSS), except the last 2 steps.Â </li><li>On page visit, send request to an attacker controlled website (eg: grab session + cookies)</li><li>The attacker can then use the stolen information in later campaigns (eg: session highjacking)</li></ul><p><strong>Procedure:</strong> <a class=link href=https://attack.mitre.org/techniques/T1189/#examples target=_blank rel=noopener>T1189</a> <em>(MITRE Attack Framework)</em> - <em>Drive-by Compromise</em></p></blockquote><h2 id=preventing-csrf-attacks>Preventing CSRF attacks</h2><p>From the business perspective, cyber security threats like CSRF should be taken very seriously, and business risks should be carefully reviewed and evaluated.</p><p>The amount of risk an organisation <em>accepts</em> to take, <em>comes from the top</em>, but they also need to be properly informed about the implications and risks, to make informed decisions.</p><p>From a technical perspective, a good place to start would be the <a class=link href=https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html target=_blank rel=noopener>OWASP CSRF Cheat Sheet</a>, and for custom software development projects, there is also:</p><ul><li><a class=link href=https://owasp.org/www-project-code-review-guide target=_blank rel=noopener>Review Code for CSRF</a></li><li><a class=link href=https://owasp.org/www-project-web-security-testing-guide/ target=_blank rel=noopener>Test for CSRF Vulnerabilities</a></li></ul><h3 id=use-a-cyber-security-framework>Use a Cyber Security Framework</h3><p>Often its hard to know where to start, and how to quantify the risk. For this reason <a class=link href=https://en.wikipedia.org/wiki/NIST_Cybersecurity_Framework target=_blank rel=noopener><strong>Cyber Security Frameworks</strong></a> were created, to help guide both <em>governments</em> and <em>organisations</em> to use standards and best practices to combat cyber crime.</p><p>I highly recommended using a cyber security framework, like <a class=link href=https://www.nist.gov/cyberframework target=_blank rel=noopener>NIST CSF</a> to quantify and evaluate your security risks on a continuous basis.</p><p><img src=/images/Why-Red-Why-Purple-A-Nist-CSF-View-May-2019.png alt="NIST Cyber Security Framework"></p><p>Its a simple process driven feedback loop, and works for organisations of any size.</p><ul><li><strong>Identify</strong> the assets that bring business value <em>(eg: customer facing servers on the internet)</em></li><li><strong>Protect</strong> assets that bring business value <em>(eg: patch & update software and OS on servers)</em></li><li><strong>Detect</strong> intrusions and monitor indicators of compromise <em>(eg: audit logs, events, <a class=link href=https://en.wikipedia.org/wiki/Security_information_and_event_management target=_blank rel=noopener>SIEM</a>)</em></li><li><strong>Respond</strong> to security incidents, prioritising most critical vulnerabilities detected, stop attacks.</li><li><strong>Recover</strong> your systems and infrastructure <em>(eg: often involves a <a class=link href=https://en.wikipedia.org/wiki/Disaster_recovery target=_blank rel=noopener>disaster recovery plan</a>)</em></li></ul><p>The last step (Recover) often feeds back into the first one (Identify), seeing that there is probably a great learning opportunity from an incident or attack, to better secure your assets in the future.</p><h1 id=summary-and-conclusion>Summary and Conclusion</h1><p>Cyber security vulnerabilities like <em>Cross Site Request Forgery</em> could leave severe impacts on your busines or organisation, and can really hurt your <em>bottom line</em> (sales & profits).</p><p>Fortunately, there is a lot of well documented and open source information on procedures and playbooks for how to deal with these kinds of threats. The <a class=link href=https://owasp.org/www-project-top-ten/ target=_blank rel=noopener>OWASP Top 10</a> is a good place to start.</p><p>A good <em>security posture</em> is also important, like adopting a <strong>Cyber Security Framework</strong> that will help you <em>quantify and mitigate</em> these kind of security risks using a structured approach.</p><h1 id=references>References</h1><ul><li><a class=link href=https://medium.com/@algorithmsunlocks/a-brief-explanation-of-the-request-response-model-in-web-development-b0081165cd67 target=_blank rel=noopener>Brief Explanation of Request-Response Model</a></li><li><a class=link href=https://en.wikipedia.org/wiki/Hyperlink target=_blank rel=noopener>Wikipedia - Hyperlink</a></li><li><a class=link href=https://en.wikipedia.org/wiki/Indicator_of_compromise target=_blank rel=noopener>Indicators of Compromise (IOC)</a></li><li><a class=link href=https://www.enisa.europa.eu/topics/incident-response/glossary/what-is-social-engineering target=_blank rel=noopener>What is Social Engineering</a></li><li><a class=link href=https://attack.mitre.org/ target=_blank rel=noopener>Mitre ATT&amp;CK framework</a></li><li><a class=link href=https://eur-lex.europa.eu/EN/legal-content/summary/general-data-protection-regulation-gdpr.html target=_blank rel=noopener>GDPR</a> (General Data Protection Regulation)</li><li><a class=link href=https://listings.pcisecuritystandards.org/documents/PCI_DSS-QRG-v3_2_1.pdf target=_blank rel=noopener>PCI DSS</a> (Payment Card Industry Data Security Standard)</li><li><a class=link href="https://www.cdc.gov/phlp/publications/topic/hipaa.html#:~:text=The%20Health%20Insurance%20Portability%20and,the%20patient%27s%20consent%20or%20knowledge." target=_blank rel=noopener>HIPPA</a> (Health Insurance Portability and Accountability Act)</li><li><a class=link href=https://www.nist.gov/cyberframework target=_blank rel=noopener>NIST CSF</a> (National Institute of Science and Technology)</li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/security/>security</a></section></footer></article><aside class=related-contents--wrapper></aside><footer class=site-footer><section class=copyright>&copy;
2023 Planet Lodder</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=2.5.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>