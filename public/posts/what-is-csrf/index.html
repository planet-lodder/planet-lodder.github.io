<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>What is Cross Site Request Forgery (CSRF)? | Planet Lodder</title><meta name=keywords content="security"><meta name=description content="In this article we explore the technical and business impacts 
that CSRF could have on your organisation."><meta name=author content="Johnathan Lodder"><link rel=canonical href=/posts/what-is-csrf/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=favicon.ico><link rel=icon type=image/png sizes=16x16 href=favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=favicon-32x32.png><link rel=apple-touch-icon href=apple-touch-icon.png><link rel=mask-icon href=safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="What is Cross Site Request Forgery (CSRF)?"><meta property="og:description" content="In this article we explore the technical and business impacts 
that CSRF could have on your organisation."><meta property="og:type" content="article"><meta property="og:url" content="/posts/what-is-csrf/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-11-06T00:00:00+00:00"><meta property="article:modified_time" content="2023-11-06T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="What is Cross Site Request Forgery (CSRF)?"><meta name=twitter:description content="In this article we explore the technical and business impacts 
that CSRF could have on your organisation."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"/posts/"},{"@type":"ListItem","position":3,"name":"What is Cross Site Request Forgery (CSRF)?","item":"/posts/what-is-csrf/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"What is Cross Site Request Forgery (CSRF)?","name":"What is Cross Site Request Forgery (CSRF)?","description":"In this article we explore the technical and business impacts \nthat CSRF could have on your organisation.","keywords":["security"],"articleBody":" Intended audience If you want to understand what CSRF is, and the impact it could have on your organisation, continue reading this article. This article was written for both business stakeholders and technical professionals.\nWe assume that you have at least a basic understanding of how websites work, more specifically, the request-response model.\nThere are 4 dedicated sections, depending on your interest and skill level:\nBasic example of CSRF Business impact of CSRF Technical impact of CSRF Preventing CSRF attacks Example of a typical CSRF attack Lets start with a very basic example of what a typical CSRF attack looks like. From OWASP, we have the following definition:\nCross-Site Request Forgery (CSRF) is an attack that forces an end user to execute unwanted actions on a web application in which they’re currently authenticated.\nIn the example below, we have a malicious user that tricks a legitimate user into clicking a link. This link will send a request (from the victim’s machine), to a website that they are currently logged into.\nSeeing that the request originates from the victim’s computer, it looks like a legitimate request from the user to the web server, and this server will happily try and process the request on behalf of the user.\nIn the example above, the attacker uses a hyperlink and is attempting to transfer money from a victim’s account using social engineering techniques. This is just one of many ways the CSRF vulnerability can be exploited, but the basic idea stays the same: trick a user into doing something unintentional, that benefits the attacker.\nWe will cover more advanced techniques \u0026 attack vectors in an upcoming section, but first, let’s zoom out a bit and take a look at the business implications CSRF can have on an organisation.\nBusiness Impacts of CSRF The successful exploitation of a CSRF attack could have far-reaching implications for any organisation. Some of the most common business risks include:\nFinancial loss / Reputational damage Unauthorised data access / Fraudulent modifications Employee impersonation / Communication breaches Data Loss / Operational Downtime Compliance, governance and regulations Lets explore each one of these business risks in more detail, and see how they have an impact on business value.\nFinancial loss / Reputational damage One of the most important business implications, is the financial impact that a cyber attack can have on an organisation. Things that can negatively impact business profits include, for example:\nPhysical assets (servers) that needs to be replaced Operational downtime, meaning missed revenue Loss of customers, due to reputational damage Fines and legal implications for non-compliance Business value comes in many forms, not just financial. For example, reputational damage could lead to a loss of customers confidence, and cause business churn or lower sales revenue.\nUnauthorised data access / Fraudulent modifications Seeing that this technique leverages ways to trick the user into doing something they did not intend to do, there is a real threat of a malicious threat actor getting access to sensitive data, or even worse, fraudulently modifying that data.\nAs illustrated in the example above, this could be in the form of a fraudulent money transfer, but could also be more subtle. For example, changing the user’s banking details, email address, or other means of extracting value from a user.\nAuditing and tracking these fraudulent transactions could also be difficult, seeing that the victim user’s fingerprints are on the transaction, not the malicious user’s.\nThere is also a real risk of data exfiltration, meaning sensitive data is stolen and copied outside of the organisation’s control.\nEmployee impersonation / Communication breaches If the target victim is an employee of the company, unauthorised data access and modification can become an even bigger risk.\nFor example, if an attacker can successfully change a user’s login details, or email address, to something the attacker controls, they can essentially take over that user’s account.\nA more subtle risk would be if the malicious user can intercept confidential communications. This could allow the attacker access to sensitive (internal) communications. They could use this to their benefit (eg: insider trading, leaking or selling IP).\nIf the user (victim) is authorised to make statements on behalf of the company, this could also be used to communicate wrong or misleading information to your customers and investors, once again contributing to reputational damage.\nData Loss / Operational Downtime In some use cases, CSRF vulnerabilities could also lead to data loss or data corruption.\nFrom a business perspective, this is important, as it could lead to operational downtime, or even worse, missing transactional records needed for accounting purposes.\nA good disaster recovery plan can help mitigate this risk, but even with a fully up-to-date and backed up database, there is still the risk that the CSRF vulnerability is present in your backup.\nThe implication being, even on a freshly installed new system, the vulnerability could still potentially be hiding in your data. This could give the attacker the ability to regain access and control.\nCompliance, governance and regulations This point is often overlooked, but companies and organisations have to comply with certain rules and regulations. This varies from industry to industry, and country to country.\nAs an example, if you process credit card transactions, then PCI DSS (Payment Card Industry Data Security Standard) comes into play. Unauthorised access to a customer’s credit card details, is punishable with a fine or even a class action lawsuit.\nIn Europe, another common one would be GDPR compliance, where organisations are responsible for safeguarding personal information about EU citizens, punishable with a fine.\nFor the health industry (especially in the US), there is also HIPPA (Health Insurance Portability and Accountability Act). Failure to comply can lead to huge fines.\nTypically, fines are set as a percentage of total yearly revenue, meaning it could have a huge impact on your company’s profit margins.\nTechnical Impacts of CSRF We already covered the business risks associated with CSRF’s, but let’s now go a bit deeper. Let’s see the technical impacts such an vulnerability can have on your IT system.\nRisks - We will first look at the most common risks to IT systems and infrastructure Attack Vectors - Then cover some common methods that are used in the wild for exploitation Indicators of Compromise - Then look at common tactics, techniques and procedures (TTP’s) Technical risks associated with CSRF We have two perspectives to consider:\nFrom an IT systems perspective a successful CSRF attack is essentially hijacking a valid (and authenticated) victim’s user account, to do something bad.\nFrom a threat actors point of view, changing user data or state would be low hanging fruit, if unprotected. For example, changing user profile \u0026 billing options (eg: email address, password, banking details).\nThis could also be used to force user purchases or other transactions without the users consent. For example, subscribing to a service that the attacker benefits from in some way.\nIf the user is an administrator, then the risk increases significantly, as the admin user typically has elevated privileges. Imagine for example, maliciously inviting or promoting other collaborators / users with admin privileges (without the administrators consent).\nTwo factor and MFA already goes a long way to mitigate these risks, but users are often reluctant and not willing to go through the extra steps. Good MFA policies should be in place and enforced in your IT systems, especially for administrative accounts.\nCommon Attack Vectors There are well know attack vectors used for successful CSRF exploitation, the common ones being:\nLogin CSRF - Force (authenticated) user to execute request to website Stored CSRF - Chained with XSS, spreads to other users (amplifies severity) Oftentimes, vulnerabilities get chained together (like in the case of stored CSRF), increasing their reach and severity significantly.\nIn the next section we will look into how these attack vectors can be chained together, and describe the tactics, techniques and procedures in more detail.\nTactics, Techniques and Procedures (TTP) Generally speaking, this refers to the behavior of a malicious actor.\nTactics refer to the high-level overview of the behavior. Techniques provide detailed descriptions of the behavior, relating to the tactic. Procedures are highly detailed descriptions of the technique. This forms part of what is called Indicators of Compromise (IOC). They are used to do advanced threat detection. One good example of a framework that uses these IOC’s, is the Mitre ATT\u0026CK framework.\nLets consider 3 use cases, where the first one is a pure CSRF exploit, then some examples that uses chained exploits to create an even more devastating attack vector.\nTactic: Social Engineering + URL hijacking\nTechnique:\nBuilding an exploit URL or script that has a CSRF vulnerability Trick users into clicking the URL using Social Engineering (eg: post on Social Media) URL opens in the browser of the target victim, sends request (validated as target user) (Optionally) Force user to log onto credential stealing clone of the original website Procedure: T1566 (MITRE Attack Framework) - Phishing\nTactic: Using code injection (eg, chained with XSS)\nTechnique:\nFind way to inject unsanitized (HTML) input into a vulnerable website Build a malicious HTML tag, (eg: IMG that triggers code) Submit malicious input to the server, stored and rendered on subsequent page loads Wait for authenticated users to login, and trigger the malicious code Malicious requests submitted to the server (forged, from the victim user’s machine) (Optionally) Attempt account takeover by changing user’s email address / other details Procedure: T1608 (MITRE Attack Framework) - Drive-by Target\nTactic: Watering hole attacks (eg, chained with XSS + CORS)\nTechnique:\nGoal is to expose/identify users of a targeted website (eg: track user activity) Same as the previous one (chained with XSS), except the last 2 steps. On page visit, send request to an attacker controlled website (eg: grab session + cookies) The attacker can then use the stolen information in later campaigns (eg: session highjacking) Procedure: T1189 (MITRE Attack Framework) - Drive-by Compromise\nPreventing CSRF attacks From the business perspective, cyber security threats like CSRF should be taken very seriously, and business risks should be carefully reviewed and evaluated.\nThe amount of risk an organisation accepts to take, comes from the top, but they also need to be properly informed about the implications and risks, to make informed decisions.\nFrom a technical perspective, a good place to start would be the OWASP CSRF Cheat Sheet, and for custom software development projects, there is also:\nReview Code for CSRF Test for CSRF Vulnerabilities Use a Cyber Security Framework Often its hard to know where to start, and how to quantify the risk. For this reason Cyber Security Frameworks were created, to help guide both governments and organisations to use standards and best practices to combat cyber crime.\nI highly recommended using a cyber security framework, like NIST CSF to quantify and evaluate your security risks on a continuous basis.\nIts a simple process driven feedback loop, and works for organisations of any size.\nIdentify the assets that bring business value (eg: customer facing servers on the internet) Protect assets that bring business value (eg: patch \u0026 update software and OS on servers) Detect intrusions and monitor indicators of compromise (eg: audit logs, events, SIEM) Respond to security incidents, prioritising most critical vulnerabilities detected, stop attacks. Recover your systems and infrastructure (eg: often involves a disaster recovery plan) The last step (Recover) often feeds back into the first one (Identify), seeing that there is probably a great learning opportunity from an incident or attack, to better secure your assets in the future.\nSummary and Conclusion Cyber security vulnerabilities like Cross Site Request Forgery could leave severe impacts on your business or organisation, and can really hurt your bottom line (sales \u0026 profits).\nFortunately, there is a lot of well documented and open source information on procedures and playbooks for how to deal with these kinds of threats. The OWASP Top 10 is a good place to start.\nA good security posture is also important, like adopting a Cyber Security Framework that will help you quantify and mitigate these kinds of security risks using a structured approach.\nReferences Brief Explanation of Request-Response Model Wikipedia - Hyperlink Indicators of Compromise (IOC) What is Social Engineering Mitre ATT\u0026CK framework GDPR (General Data Protection Regulation) PCI DSS (Payment Card Industry Data Security Standard) HIPPA (Health Insurance Portability and Accountability Act) NIST CSF (National Institute of Science and Technology) ","wordCount":"2057","inLanguage":"en","datePublished":"2023-11-06T00:00:00Z","dateModified":"2023-11-06T00:00:00Z","author":{"@type":"Person","name":"Johnathan Lodder"},"mainEntityOfPage":{"@type":"WebPage","@id":"/posts/what-is-csrf/"},"publisher":{"@type":"Organization","name":"Planet Lodder","logo":{"@type":"ImageObject","url":"favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href accesskey=h title="Planet Lodder (Alt + H)">Planet Lodder</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=/about/ title=About><span>About</span></a></li><li><a href=/posts/ title="Blog Posts"><span>Blog Posts</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>What is Cross Site Request Forgery (CSRF)?</h1><div class=post-description>In this article we explore the technical and business impacts
that CSRF could have on your organisation.</div><div class=post-meta><span title='2023-11-06 00:00:00 +0000 UTC'>November 6, 2023</span>&nbsp;·&nbsp;Johnathan Lodder</div></header><div class=post-content><blockquote><h3 id=intended-audience>Intended audience<a hidden class=anchor aria-hidden=true href=#intended-audience>#</a></h3><p>If you want to understand what CSRF is, and the impact it could have on your organisation, continue reading this article. This article was written for both <strong>business stakeholders</strong> and <strong>technical professionals</strong>.</p><p>We assume that you have at least a basic understanding of how websites work, more specifically, the <a href=https://medium.com/@algorithmsunlocks/a-brief-explanation-of-the-request-response-model-in-web-development-b0081165cd67>request-response model</a>.</p></blockquote><p>There are 4 dedicated sections, depending on your interest and skill level:</p><ul><li><a href=#example-of-a-typical-csrf-attack>Basic example of CSRF</a></li><li><a href=#business-impacts-of-csrf>Business impact of CSRF</a></li><li><a href=#technical-impacts-of-csrf>Technical impact of CSRF</a></li><li><a href=#preventing-csrf-attacks>Preventing CSRF attacks</a></li></ul><h1 id=example-of-a-typical-csrf-attack>Example of a typical CSRF attack<a hidden class=anchor aria-hidden=true href=#example-of-a-typical-csrf-attack>#</a></h1><p>Lets start with a very basic example of what a typical CSRF attack looks like. From <a href=https://owasp.org/www-community/attacks/csrf>OWASP</a>, we have the following definition:</p><blockquote><p>Cross-Site Request Forgery (CSRF) is an attack that forces an end user to execute unwanted actions on a web application in which they’re currently authenticated.</p></blockquote><p>In the example below, we have a malicious user that tricks a legitimate user into clicking a link. This link will send a request (from the victim&rsquo;s machine), to a website that they are currently logged into.</p><p><img loading=lazy src=images/CSRF_basics.png alt="Basic example of a CSRF attack"></p><p>Seeing that the request originates from the victim&rsquo;s computer, it looks like a legitimate request from the user to the web server, and this server will happily try and process the request on behalf of the user.</p><p>In the example above, the attacker uses a <a href=https://en.wikipedia.org/wiki/Hyperlink><em>hyperlink</em></a> and is attempting to transfer money from a victim&rsquo;s account using <a href=https://www.enisa.europa.eu/topics/incident-response/glossary/what-is-social-engineering><em>social engineering</em></a> techniques. This is <em>just one of many ways</em> the CSRF vulnerability can be exploited, but the basic idea stays the same: <em>trick a user into doing something unintentional</em>, that benefits the attacker.</p><p>We will cover more advanced techniques & attack vectors <a href=#tactics-techniques-and-procedures-ttp>in an upcoming section</a>, but first, let&rsquo;s zoom out a bit and take a look at the business implications CSRF can have on an organisation.</p><h1 id=business-impacts-of-csrf>Business Impacts of CSRF<a hidden class=anchor aria-hidden=true href=#business-impacts-of-csrf>#</a></h1><p>The successful exploitation of a CSRF attack could have far-reaching implications for any organisation. Some of the most common business risks include:</p><ul><li><a href=#financial-loss--reputational-damage>Financial loss / Reputational damage</a></li><li><a href=#unauthorised-data-access--fraudulent-modifications>Unauthorised data access / Fraudulent modifications</a></li><li><a href=#employee-impersonation--communication-breaches>Employee impersonation / Communication breaches</a></li><li><a href=#data-loss--operational-downtime>Data Loss / Operational Downtime</a></li><li><a href=#compliance-governance-and-regulations>Compliance, governance and regulations</a></li></ul><p>Lets explore each one of these business risks in more detail, and see how they have an impact on business value.</p><h2 id=financial-loss--reputational-damage>Financial loss / Reputational damage<a hidden class=anchor aria-hidden=true href=#financial-loss--reputational-damage>#</a></h2><p>One of the most important business implications, is the <em>financial impact</em> that a cyber attack can have on an organisation. Things that can negatively impact business profits include, for example:</p><ul><li>Physical assets (servers) that needs to be replaced</li><li>Operational downtime, meaning missed revenue</li><li>Loss of customers, due to reputational damage</li><li>Fines and legal implications for non-compliance</li></ul><p>Business value comes in many forms, not just financial. For example, reputational damage could lead to <em>a loss of customers confidence</em>, and cause business churn or lower sales revenue.</p><h2 id=unauthorised-data-access--fraudulent-modifications>Unauthorised data access / Fraudulent modifications<a hidden class=anchor aria-hidden=true href=#unauthorised-data-access--fraudulent-modifications>#</a></h2><p>Seeing that this technique leverages ways to trick the user into doing something they did not intend to do, there is a real threat of a malicious threat actor getting access to sensitive data, or even worse, fraudulently modifying that data.</p><p>As illustrated in the <a href=#example-of-a-typical-csrf-attack>example above</a>, this could be in the form of a fraudulent money transfer, but could also be more subtle. For example, changing the user&rsquo;s banking details, email address, or other means of extracting value from a user.</p><p>Auditing and tracking these fraudulent transactions could also be difficult, seeing that the victim user&rsquo;s fingerprints are on the transaction, not the malicious user&rsquo;s.</p><p>There is also a real risk of data exfiltration, meaning sensitive data is stolen and copied outside of the organisation&rsquo;s control.</p><h2 id=employee-impersonation--communication-breaches>Employee impersonation / Communication breaches<a hidden class=anchor aria-hidden=true href=#employee-impersonation--communication-breaches>#</a></h2><p>If the target victim is an employee of the company, unauthorised data access and modification can become an even bigger risk.</p><p>For example, if an attacker can successfully change a user&rsquo;s login details, or email address, to something the attacker controls, they can essentially take over that user&rsquo;s account.</p><p>A more subtle risk would be if the malicious user can intercept confidential communications. This could allow the attacker access to sensitive (internal) communications. They could use this to their benefit (eg: insider trading, leaking or selling IP).</p><p>If the user (victim) is authorised to make statements on behalf of the company, this could also be used to communicate wrong or misleading information to your customers and investors, once again contributing to reputational damage.</p><h2 id=data-loss--operational-downtime>Data Loss / Operational Downtime<a hidden class=anchor aria-hidden=true href=#data-loss--operational-downtime>#</a></h2><p>In some use cases, CSRF vulnerabilities could also lead to <em>data loss</em> or <em>data corruption</em>.</p><p>From a business perspective, this is important, as it could lead to operational downtime, or even worse, missing transactional records needed for accounting purposes.</p><p>A good disaster recovery plan can help mitigate this risk, but even with a fully up-to-date and backed up database, there is still the risk that the CSRF vulnerability is present in your backup.</p><p>The implication being, even on a freshly installed new system, the vulnerability could still potentially be hiding in your data. This could give the attacker the ability to regain access and control.</p><h2 id=compliance-governance-and-regulations>Compliance, governance and regulations<a hidden class=anchor aria-hidden=true href=#compliance-governance-and-regulations>#</a></h2><p>This point is often overlooked, but companies and organisations have to comply with certain rules and regulations. This varies from industry to industry, and country to country.</p><p>As an example, if you process credit card transactions, then <a href=https://listings.pcisecuritystandards.org/documents/PCI_DSS-QRG-v3_2_1.pdf>PCI DSS</a> (Payment Card Industry Data Security Standard) comes into play. Unauthorised access to a customer&rsquo;s credit card details, is punishable with a fine or even a class action lawsuit.</p><p>In Europe, another common one would be <a href=https://eur-lex.europa.eu/EN/legal-content/summary/general-data-protection-regulation-gdpr.html>GDPR</a> compliance, where organisations are responsible for safeguarding personal information about EU citizens, punishable with a fine.</p><p>For the health industry (especially in the US), there is also <a href="https://www.cdc.gov/phlp/publications/topic/hipaa.html#:~:text=The%20Health%20Insurance%20Portability%20and,the%20patient's%20consent%20or%20knowledge.">HIPPA</a> (Health Insurance Portability and Accountability Act). Failure to comply can lead to huge fines.</p><p>Typically, fines are set as a percentage of total yearly revenue, meaning it could have a huge impact on your company&rsquo;s profit margins.</p><h1 id=technical-impacts-of-csrf>Technical Impacts of CSRF<a hidden class=anchor aria-hidden=true href=#technical-impacts-of-csrf>#</a></h1><p>We already covered the business risks associated with CSRF&rsquo;s, but let&rsquo;s now go a bit deeper. Let&rsquo;s see the technical impacts such an vulnerability can have on your IT system.</p><ul><li><a href=#technical-risks-associated-with-csrf><strong>Risks</strong></a> - We will first look at the most common risks to IT systems and infrastructure</li><li><a href=#common-attack-vectors><strong>Attack Vectors</strong></a> - Then cover some common methods that are used in the wild for exploitation</li><li><a href=#tactics-techniques-and-procedures-ttp><strong>Indicators of Compromise</strong></a> - Then look at common tactics, techniques and procedures (TTP&rsquo;s)</li></ul><h2 id=technical-risks-associated-with-csrf>Technical risks associated with CSRF<a hidden class=anchor aria-hidden=true href=#technical-risks-associated-with-csrf>#</a></h2><p>We have two perspectives to consider:</p><ul><li><p>From an IT systems perspective a successful CSRF attack is essentially hijacking a valid (and authenticated) victim&rsquo;s user account, to do something <em>bad</em>.</p></li><li><p>From a threat actors point of view, changing user data or state would be low hanging fruit, if unprotected. For example, changing user profile & billing options (eg: email address, password, banking details).</p></li></ul><p>This could also be used to force user purchases or other transactions without the users consent. For example, subscribing to a service that the attacker benefits from in some way.</p><p>If the user is an administrator, then the risk increases significantly, as the admin user typically has elevated privileges. Imagine for example, maliciously inviting or promoting other collaborators / users with admin privileges (without the administrators consent).</p><p>Two factor and MFA already goes a long way to mitigate these risks, but users are often reluctant and not willing to go through the extra steps. Good MFA policies should be in place and enforced in your IT systems, especially for administrative accounts.</p><h2 id=common-attack-vectors>Common Attack Vectors<a hidden class=anchor aria-hidden=true href=#common-attack-vectors>#</a></h2><p>There are well know attack vectors used for successful CSRF exploitation, the common ones being:</p><ul><li><a href=https://crashtest-security.com/csrf-login-attack/><strong>Login CSRF</strong></a> - <em>Force (authenticated) user to execute request to website</em></li><li><a href=https://crashtest-security.com/stored-csrf-attack/><strong>Stored CSRF</strong></a> - <em>Chained with XSS, spreads to other users (<strong>amplifies severity</strong>)</em></li></ul><p>Oftentimes, vulnerabilities get <em>chained together</em> (like in the case of stored CSRF), increasing their reach and severity significantly.</p><p>In the next section we will look into how these attack vectors can be chained together, and describe the tactics, techniques and procedures in more detail.</p><h2 id=tactics-techniques-and-procedures-ttp>Tactics, Techniques and Procedures (TTP)<a hidden class=anchor aria-hidden=true href=#tactics-techniques-and-procedures-ttp>#</a></h2><p>Generally speaking, this refers to the behavior of a malicious actor.</p><ul><li><strong>Tactics</strong> refer to the high-level overview of the behavior.</li><li><strong>Techniques</strong> provide detailed descriptions of the behavior, relating to the tactic.</li><li><strong>Procedures</strong> are highly detailed descriptions of the technique.</li></ul><p>This forms part of what is called <a href=https://en.wikipedia.org/wiki/Indicator_of_compromise><em>Indicators of Compromise</em> (IOC)</a>. They are used to do advanced threat detection. One good example of a framework that uses these IOC&rsquo;s, is the <a href=https://attack.mitre.org/>Mitre ATT&amp;CK</a> framework.</p><p>Lets consider 3 use cases, where the first one is a pure CSRF exploit, then some examples that uses chained exploits to create an even more devastating attack vector.</p><blockquote><p><strong>Tactic:</strong> Social Engineering + URL hijacking</p><p><strong>Technique:</strong></p><ul><li>Building an exploit URL or script that has a CSRF vulnerability</li><li>Trick users into clicking the URL using Social Engineering (eg: post on Social Media)</li><li>URL opens in the browser of the target victim, sends request (validated as target user)</li><li>(Optionally) Force user to log onto credential stealing clone of the original website</li></ul><p><strong>Procedure:</strong> <a href=https://attack.mitre.org/techniques/T1566/#examples>T1566</a> <em>(MITRE Attack Framework)</em> - <em>Phishing</em></p></blockquote><blockquote><p><strong>Tactic:</strong> Using code injection <em>(eg, chained with XSS)</em></p><p><strong>Technique:</strong></p><ul><li>Find way to inject unsanitized (HTML) input into a vulnerable website</li><li>Build a malicious HTML tag, (eg: IMG that triggers code)</li><li>Submit malicious input to the server, stored and rendered on subsequent page loads</li><li>Wait for authenticated users to login, and trigger the malicious code</li><li>Malicious requests submitted to the server (forged, from the victim user&rsquo;s machine)</li><li>(Optionally) Attempt account takeover by changing user&rsquo;s email address / other details</li></ul><p><strong>Procedure:</strong> <a href=https://attack.mitre.org/techniques/T1608/004/#examples>T1608</a> <em>(MITRE Attack Framework)</em> - <em>Drive-by Target</em></p></blockquote><blockquote><p><strong>Tactic:</strong> Watering hole attacks <em>(eg, chained with XSS + CORS)</em></p><p><strong>Technique:</strong></p><ul><li>Goal is to expose/identify users of a targeted website (eg: track user activity)</li><li>Same as the previous one (chained with XSS), except the last 2 steps. </li><li>On page visit, send request to an attacker controlled website (eg: grab session + cookies)</li><li>The attacker can then use the stolen information in later campaigns (eg: session highjacking)</li></ul><p><strong>Procedure:</strong> <a href=https://attack.mitre.org/techniques/T1189/#examples>T1189</a> <em>(MITRE Attack Framework)</em> - <em>Drive-by Compromise</em></p></blockquote><h2 id=preventing-csrf-attacks>Preventing CSRF attacks<a hidden class=anchor aria-hidden=true href=#preventing-csrf-attacks>#</a></h2><p>From the business perspective, cyber security threats like CSRF should be taken very seriously, and business risks should be carefully reviewed and evaluated.</p><p>The amount of risk an organisation <em>accepts</em> to take, <em>comes from the top</em>, but they also need to be properly informed about the implications and risks, to make informed decisions.</p><p>From a technical perspective, a good place to start would be the <a href=https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html>OWASP CSRF Cheat Sheet</a>, and for custom software development projects, there is also:</p><ul><li><a href=https://owasp.org/www-project-code-review-guide>Review Code for CSRF</a></li><li><a href=https://owasp.org/www-project-web-security-testing-guide/>Test for CSRF Vulnerabilities</a></li></ul><h3 id=use-a-cyber-security-framework>Use a Cyber Security Framework<a hidden class=anchor aria-hidden=true href=#use-a-cyber-security-framework>#</a></h3><p>Often its hard to know where to start, and how to quantify the risk. For this reason <a href=https://en.wikipedia.org/wiki/NIST_Cybersecurity_Framework><strong>Cyber Security Frameworks</strong></a> were created, to help guide both <em>governments</em> and <em>organisations</em> to use standards and best practices to combat cyber crime.</p><p>I highly recommended using a cyber security framework, like <a href=https://www.nist.gov/cyberframework>NIST CSF</a> to quantify and evaluate your security risks on a continuous basis.</p><p><img loading=lazy src=images/Why-Red-Why-Purple-A-Nist-CSF-View-May-2019.png alt="NIST Cyber Security Framework"></p><p>Its a simple process driven feedback loop, and works for organisations of any size.</p><ul><li><strong>Identify</strong> the assets that bring business value <em>(eg: customer facing servers on the internet)</em></li><li><strong>Protect</strong> assets that bring business value <em>(eg: patch & update software and OS on servers)</em></li><li><strong>Detect</strong> intrusions and monitor indicators of compromise <em>(eg: audit logs, events, <a href=https://en.wikipedia.org/wiki/Security_information_and_event_management>SIEM</a>)</em></li><li><strong>Respond</strong> to security incidents, prioritising most critical vulnerabilities detected, stop attacks.</li><li><strong>Recover</strong> your systems and infrastructure <em>(eg: often involves a <a href=https://en.wikipedia.org/wiki/Disaster_recovery>disaster recovery plan</a>)</em></li></ul><p>The last step (Recover) often feeds back into the first one (Identify), seeing that there is probably a great learning opportunity from an incident or attack, to better secure your assets in the future.</p><h1 id=summary-and-conclusion>Summary and Conclusion<a hidden class=anchor aria-hidden=true href=#summary-and-conclusion>#</a></h1><p>Cyber security vulnerabilities like <em>Cross Site Request Forgery</em> could leave severe impacts on your business or organisation, and can really hurt your <em>bottom line</em> (sales & profits).</p><p>Fortunately, there is a lot of well documented and open source information on procedures and playbooks for how to deal with these kinds of threats. The <a href=https://owasp.org/www-project-top-ten/>OWASP Top 10</a> is a good place to start.</p><p>A good <em>security posture</em> is also important, like adopting a <strong>Cyber Security Framework</strong> that will help you <em>quantify and mitigate</em> these kinds of security risks using a structured approach.</p><h1 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h1><ul><li><a href=https://medium.com/@algorithmsunlocks/a-brief-explanation-of-the-request-response-model-in-web-development-b0081165cd67>Brief Explanation of Request-Response Model</a></li><li><a href=https://en.wikipedia.org/wiki/Hyperlink>Wikipedia - Hyperlink</a></li><li><a href=https://en.wikipedia.org/wiki/Indicator_of_compromise>Indicators of Compromise (IOC)</a></li><li><a href=https://www.enisa.europa.eu/topics/incident-response/glossary/what-is-social-engineering>What is Social Engineering</a></li><li><a href=https://attack.mitre.org/>Mitre ATT&amp;CK framework</a></li><li><a href=https://eur-lex.europa.eu/EN/legal-content/summary/general-data-protection-regulation-gdpr.html>GDPR</a> (General Data Protection Regulation)</li><li><a href=https://listings.pcisecuritystandards.org/documents/PCI_DSS-QRG-v3_2_1.pdf>PCI DSS</a> (Payment Card Industry Data Security Standard)</li><li><a href="https://www.cdc.gov/phlp/publications/topic/hipaa.html#:~:text=The%20Health%20Insurance%20Portability%20and,the%20patient's%20consent%20or%20knowledge.">HIPPA</a> (Health Insurance Portability and Accountability Act)</li><li><a href=https://www.nist.gov/cyberframework>NIST CSF</a> (National Institute of Science and Technology)</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=/tags/security/>security</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href>Planet Lodder</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>